<!DOCTYPE html>
<html>
<head>
	<title>{{title}}</title>
</head>
<body>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

	<link rel="stylesheet" type="text/css" href="/static/main.css">

	<div class='page'>
	<div class='row '>
		<div class='col-6'>
		<h2> HTTP Playground </h2>
		<h3> Headers </h3>
		<ul>
		{% for key, value in request_info.headers.items() %}
			<li>{{key}}  - {{ value }}</li>
		{% else %}
			- Nothing found here -
		{% endfor %}
		</ul>
		
		</div>
		<div class='col-6'>
		<h3> Query Params </h3>

		<ul>
		{% for key, value in request_info.query_params.items() %}
			<li>{{key}}  - {{ value }}</li>
		{% else %}
			- Nothing found here -
		{% endfor %}

		</ul>
		

		<h3> Form </h3>

		<ul>
		{% for key, value in request_info.form.items() %}
			<li>{{key}}  - {{ value }}</li>
		{% else %}
			- Nothing found here -
		{% endfor %}
		</ul>
		

		<h4> Cookies </h4>
		<ul>
		{% for key, value in request_info.cookies.items() %}
			<li>{{key}}  - {{ value }}</li>
		{% else %}
			- Nothing found here -
		{% endfor %}
		</ul>
		

		<h4> Session </h4>
		<ul>
		{% for key, value in request_info.session.items() %}
			<li>{{key}}  - {{ value }}</li>
		{% else %}
			- Nothing found here -
		{% endfor %}
		</ul>
	</div>
</div>
<hr>
{% raw %}
<div id='app'>
	<div class='row'>
		<div class='col-3'>
	<h2> {{title}} </h2>
</div>
<div class='col-6'>
<button class='btn btn-default' v-on:click='fetchApi()'> Fetch </button>
</div>
</div>
<div class='col-6'>

	</div>
<div class='row'>
	<div class='col-6'>
		

		
		
		<div id='request-content'>
			<h3> XHR Request </h3>
			<pre>
				{{request}}
			</pre>
		</div>
		

		

	</div>
	<div class='col-6'>

		<div id='response-content'>
			<h3> Response Body</h3>
			<pre>
				{{response}}
			</pre>
		</div>

	</div>
</div>

{% endraw %}


</div>
</div>
<script type='text/javascript'>


$(document).ready(function(){

	$.ajaxSetup({
    beforeSend: function (event, xhr, options) {
        var request_info = JSON.stringify(xhr, null, 2);
	    $(document).trigger("requestSent", request_info);
	    }
	    
	});


	var app = new Vue({
  	el: '#app',
  	data: {
    	title: 'Vue Powered Playkit',
    	response: '',
    	request: ''
  	},
  	mounted: function(){
  		var that = this;
  		$(document).on("requestSent", function(event, requestInfo){
  			that.request = requestInfo;
  		});

  	},
  	methods: {
  		fetchApi: function(){
  			console.log('fetching api');
  			var that = this;
  			var params = {name: 'get-request', ts: Date.now(), dt: Date().toString()};

  			$.get( "/api/", params, function( data ) {
			  that.response = JSON.stringify(JSON.parse(data), null, 2);
			});
  		},
  		postApi: function(){
  			console.log('posting form to api');	
  		}
  	}
	});

});



</script>
</body>
</html>